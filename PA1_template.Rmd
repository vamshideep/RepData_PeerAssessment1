# Reproducible Research: Peer Assessment 1


## Loading and preprocessing the data
1) We check for data directory, if it doesn't exist we create a data directory
2) We then download the file into the data directory
3) Unzip the file into data directory and read the file
4) We convert date field to Date type

```{r loadingData,echo=TRUE}
library(knitr)
if(!file.exists("./data")){
  dir.create("./data")
  fileUrl <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
  download.file(fileUrl,dest="./data/activity.zip")
  unzip("./data/activity.zip",exdir="./data")
  
  }
activity <- read.csv("./data/activity.csv")
activity$date <- as.Date(activity$date,"%Y-%m-%d")
```

## What is mean total number of steps taken per day?

```{r,echo=TRUE}
head(activity)
library(reshape2)
activitymelt <- melt(activity,id=c("date","interval"),na.rm=TRUE)
activitydcast <- dcast(activitymelt,date~variable,sum,na.rm=TRUE)
mean(activitydcast$steps)
median(activitydcast$steps)
str(activitydcast)
hist(activitydcast$steps)

library(ggplot2)

ggplot(activitydcast, aes(x = steps)) + geom_histogram() + labs(x = "Number of Steps taken per day", 
        y = "Sum") + theme_bw() + theme(legend.position = "bottom")
steps_per_day <- aggregate(steps ~ date, activity, sum)
class(steps_per_day)
head(steps_per_day)
```


## What is the average daily activity pattern?

```{r}
activitymelt2 <- melt(activity,id=c("interval","date"),na.rm=TRUE)

activitydcast2 <- dcast(activitymelt2,interval~variable,mean)

head(activitydcast2,n=5)
summary(activitydcast2$steps)
activitydcast2$interval[which.max(activitydcast2$steps)]

steps_pi <- aggregate(activity$steps, by = list(interval = activity$interval), FUN = mean, 
        na.rm = T)

head(steps_pi)
```

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
